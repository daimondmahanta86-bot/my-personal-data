<!DOCTYPE html>
<!-- saved from url=(0032)http://127.0.0.1:3000/index.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" src="./My Own Operating SYSTEM_files/___vscode_livepreview_injected_script"></script><script type="text/javascript" src="file:///C:/___vscode_livepreview_injected_script"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daimond's Divine Planner (Ultimate)</title>
    <script src="./My Own Operating SYSTEM_files/chart.js.download"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
    // --- FIREBASE CONFIGURATION ---
    const firebaseConfig = { 
        apiKey: "AIzaSyCLD87imksmqI2uENX4PVRDcnun3WxTdbk", 
        authDomain: "mera-personal-data.firebaseapp.com", 
        databaseURL: "https://mera-personal-data-default-rtdb.firebaseio.com", 
        projectId: "mera-personal-data", 
        storageBucket: "mera-personal-data.firebasestorage.app", 
        messagingSenderId: "304579476606", 
        appId: "1:304579476606:web:8fa78fee9cbe2f301f2c2f" 
    };

    let dbRef;
    
    // Initialize Firebase
    function initFirebase() {
        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            
            // Database Reference (Unique Path for v16)
            dbRef = firebase.database().ref('diamond_os_v16_verdict');

            // Listen for Data Changes (Load Data)
            dbRef.on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    // Merge cloud data with current app state
                    appState = { ...appState, ...data };
                    
                    // Logic Checks after loading data
                    checkDailyReset();
                    checkLock();
                    updateUI();
                    
                    // UI Feedback
                    document.getElementById('cloud-status').innerText = "â˜ï¸ ONLINE";
                    document.getElementById('cloud-status').style.color = "#00ff41"; // Green
                } else {
                    // New User / No Data Found
                    document.getElementById('cloud-status').innerText = "â˜ï¸ NEW USER";
                    saveData(); // Create initial data
                }
            });

            // Start Clock
            setInterval(() => {
                document.getElementById('clock').innerText = new Date().toLocaleTimeString();
                checkDailyReset();
            }, 1000);

        } catch (error) {
            console.error("Firebase Error:", error);
            document.getElementById('cloud-status').innerText = "â˜ï¸ OFFLINE";
            document.getElementById('cloud-status').style.color = "#ff0000"; // Red
        }
    }

    // Save Data Function
    function saveData() {
        if (dbRef) {
            dbRef.set(appState).then(() => {
                console.log("Data Synced");
            }).catch((error) => {
                console.error("Sync Failed", error);
            });
        }
    }
    </script>

    <style>
        /* --- THEME VARIABLES --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            --container-bg: rgba(20, 20, 40, 0.95);
            --text-color: #e0e0e0;
            --gold-accent: #ffd700; 
            --saffron: #ff9933;
            --peacock-green: #00ffcc; 
            --mistake-red: #ff4d4d;
            --border-color: #444;
            --profit-green: #2ecc71;
            --slot-bg: rgba(255,255,255,0.02);
            --slot-hover: rgba(255,255,255,0.08);
            --detail-btn-color: #aaa;
        }
        /* THEME CLASSES */
        body.theme-warzone { --bg-gradient: linear-gradient(135deg, #000000, #1a0505, #2c0000); --container-bg: rgba(20, 0, 0, 0.95); --gold-accent: #ff4d4d; --peacock-green: #ff9f43; --text-color: #e0e0e0; --border-color: #550000; }
        body.theme-matrix { --bg-gradient: linear-gradient(135deg, #000000, #0a1a0a, #001100); --container-bg: rgba(0, 20, 0, 0.95); --gold-accent: #00ff00; --peacock-green: #00ff00; --mistake-red: #ff0055; --text-color: #00dd00; --border-color: #004400; }
        body.theme-zen { --bg-gradient: linear-gradient(135deg, #f5f7fa, #c3cfe2); --container-bg: rgba(255, 255, 255, 0.95); --text-color: #333; --gold-accent: #2980b9; --peacock-green: #27ae60; --border-color: #ccc; --slot-bg: rgba(0,0,0,0.02); --slot-hover: rgba(0,0,0,0.05); --detail-btn-color: #555; }

        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg-gradient); background-attachment: fixed; margin: 0; padding: 20px; color: var(--text-color); min-height: 100vh; overflow-x: hidden; transition: background 0.5s ease; }
        body.theme-zen select, body.theme-zen input, body.theme-zen textarea { color: #333; background: rgba(0,0,0,0.05); }
        body.theme-zen .modal-content { background: #fff; color: #333; }
        body.theme-zen .score-board, body.theme-zen .pnl-board, body.theme-zen .brahmacharya-board, body.theme-zen .rank-badge, body.theme-zen .screen-time-board { background: rgba(0,0,0,0.05); }

        .container { max-width: 1100px; margin: 0 auto; background: var(--container-bg); padding: 30px; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.5), 0 0 10px var(--gold-accent); border: 1px solid var(--gold-accent); backdrop-filter: blur(10px); transition: all 0.5s ease; }

        /* Header & Rank */
        header { text-align: center; margin-bottom: 20px; border-bottom: 1px solid var(--gold-accent); padding-bottom: 20px; position: relative; }
        .user-name { font-size: 1.4rem; color: var(--peacock-green); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 5px; font-weight: bold; text-shadow: 0 0 10px rgba(0, 255, 204, 0.3); }
        .odia-quote { color: var(--gold-accent); font-size: 1.6rem; font-weight: bold; text-shadow: 0 0 5px rgba(255, 215, 0, 0.2); margin-bottom: 10px; }
        .eng-subtitle { color: var(--text-color); opacity: 0.7; font-style: italic; font-size: 0.9rem; }
        
        .rank-badge { position: absolute; right: 0; top: 0; background: rgba(255, 215, 0, 0.1); border: 1px solid var(--gold-accent); padding: 5px 15px; border-radius: 20px; font-weight: bold; color: var(--gold-accent); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(255, 215, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); } }

        /* Controls */
        .top-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        .date-nav { display: flex; align-items: center; gap: 10px; }
        .btn { background: transparent; color: var(--gold-accent); border: 1px solid var(--gold-accent); padding: 8px 16px; border-radius: 20px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .btn:hover { background: var(--gold-accent); color: var(--container-bg); }
        .btn-analyze { background: rgba(0, 255, 204, 0.1); color: var(--peacock-green); border-color: var(--peacock-green); }
        .btn-calc { background: rgba(52, 152, 219, 0.1); color: #3498db; border-color: #3498db; }
        .btn-ritual { background: rgba(255, 159, 67, 0.1); color: #ff9f43; border-color: #ff9f43; }
        .btn-music { background: rgba(153, 102, 255, 0.1); color: #9966ff; border-color: #9966ff; }
        .btn-mission { background: rgba(255, 215, 0, 0.2); border-color: var(--gold-accent); box-shadow: 0 0 10px var(--gold-accent); animation: pulse 3s infinite; }

        /* Shift Selector */
        .shift-select { background: rgba(0,0,0,0.3); border: 1px solid var(--gold-accent); color: var(--text-color); padding: 8px; border-radius: 20px; cursor: pointer; font-weight: bold; }
        .shift-select option { background: #1a1a2e; color: white; }

        /* YES / NO BUTTONS */
        .btn-yes { border-color: var(--peacock-green); color: var(--peacock-green); padding: 5px 15px; margin: 0 5px; }
        .btn-yes:hover { background: var(--peacock-green); color: black; box-shadow: 0 0 10px var(--peacock-green); }
        .btn-no { border-color: var(--mistake-red); color: var(--mistake-red); padding: 5px 15px; margin: 0 5px; }
        .btn-no:hover { background: var(--mistake-red); color: white; box-shadow: 0 0 10px var(--mistake-red); }

        input[type="date"] { background: rgba(255,255,255,0.1); color: var(--text-color); border: 1px solid var(--border-color); padding: 5px 10px; border-radius: 5px; }

        /* Dashboard */
        .dashboard-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 20px; }
        .score-board, .pnl-board, .brahmacharya-board, .screen-time-board { text-align: center; padding: 15px; background: rgba(0, 0, 0, 0.3); border-radius: 10px; border: 1px solid var(--border-color); display: flex; justify-content: space-around; align-items: center; }
        .pnl-board, .screen-time-board { flex-direction: column; gap: 5px; }
        .pnl-board { border-color: var(--peacock-green); }
        
        /* RESULT STAMP */
        .result-stamp { border: 3px double; padding: 5px 10px; transform: rotate(-5deg); font-weight: 900; letter-spacing: 2px; font-size: 1.4rem; text-transform: uppercase; transition: all 0.3s ease; display: inline-block; }
        .stamp-pass { color: var(--profit-green); border-color: var(--profit-green); text-shadow: 0 0 10px var(--profit-green); }
        .stamp-fail { color: var(--mistake-red); border-color: var(--mistake-red); text-shadow: 0 0 10px var(--mistake-red); }
        .stamp-neutral { color: #555; border-color: #555; }

        /* Screen Time Specific */
        .screen-time-board { border-color: #36a2eb; }
        .screen-inputs { display: flex; gap: 5px; justify-content: center; align-items: center; }
        .screen-input-small { width: 40px; padding: 5px; text-align: center; background: rgba(0,0,0,0.2); border: 1px solid #555; color: white; border-radius: 5px; }
        
        /* Brahmacharya Specific */
        .brahmacharya-board { flex-direction: column; border: 1px solid var(--saffron); position: relative; overflow: hidden; transition: all 0.5s ease; }
        .streak-val { font-size: 2.2rem; font-weight: bold; color: var(--saffron); text-shadow: 0 0 10px rgba(255, 153, 51, 0.3); }
        .streak-label { color: #aaa; font-size: 0.8rem; }
        .brahmacharya-status-text { margin-top: 10px; font-weight: bold; color: var(--peacock-green); font-size: 1.1rem; display: none; }

        .score-val { font-size: 2rem; font-weight: bold; color: var(--peacock-green); }
        .score-label { font-size: 0.8rem; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; }

        .pnl-input { background: transparent; border: none; border-bottom: 2px solid var(--border-color); color: var(--text-color); font-size: 1.2rem; text-align: center; width: 80%; }
        .pnl-input:focus { outline: none; border-color: var(--gold-accent); }
        .mindset-select { background: rgba(0,0,0,0.2); color: var(--text-color); border: 1px solid var(--border-color); padding: 5px; border-radius: 5px; width: 90%; }

        /* Schedule */
        .schedule-grid { border: 1px solid var(--border-color); margin-bottom: 30px; display: flex; flex-direction: column; }
        .time-slot { display: flex; align-items: center; border-bottom: 1px solid var(--border-color); background: var(--slot-bg); padding-right: 10px; position: relative; }
        .time-slot:hover { background: var(--slot-hover); }
        .time-label { flex: 0 0 85px; padding: 10px; color: var(--gold-accent); border-right: 1px solid var(--border-color); text-align: center; font-size: 0.85rem; font-weight: bold; }
        .cat-select { background: transparent; border: none; font-size: 1.2rem; cursor: pointer; margin-right: 5px; padding: 5px; width: 50px; }
        .task-input { flex: 1; border: none; padding: 12px; background: transparent; color: var(--text-color); font-size: 1rem; outline: none; }
        .task-done { text-decoration: line-through; opacity: 0.6; }
        
        .action-group { display: flex; align-items: center; gap: 8px; }
        .done-click-btn { background: transparent; border: 1px solid var(--peacock-green); color: var(--peacock-green); border-radius: 50%; width: 28px; height: 28px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .done-click-btn:hover { background: var(--peacock-green); color: black; }
        .btn-checked { background: var(--peacock-green); color: black; }
        .detail-btn { background: none; border: none; cursor: pointer; font-size: 1.2rem; color: var(--detail-btn-color); transition: 0.3s; opacity: 0.5; }
        .detail-btn:hover { opacity: 1; transform: scale(1.1); color: var(--gold-accent); }
        .detail-active { color: var(--gold-accent); opacity: 1; text-shadow: 0 0 5px var(--gold-accent); }
        .cal-btn { background: none; border: none; cursor: pointer; font-size: 1.2rem; opacity: 0.5; color: var(--detail-btn-color); }
        .cal-btn:hover { opacity: 1; transform: scale(1.1); }
        input[type="checkbox"] { display: none; }

        /* Effects */
        @keyframes flashGold { 0% { background-color: var(--gold-accent); } 100% { background-color: transparent; } }
        .victory-glow { animation: flashGold 0.8s ease-out; }
        .confetti { position: absolute; width: 8px; height: 8px; border-radius: 50%; pointer-events: none; z-index: 9999; }

        /* Mistakes & Reflections */
        .reflections { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; border-top: 2px dashed var(--border-color); padding-top: 20px; }
        .reflection-box { background: rgba(0, 0, 0, 0.2); padding: 15px; border-radius: 10px; border: 1px solid var(--border-color); }
        .full-width { grid-column: span 2; }
        .reflection-title { color: var(--gold-accent); margin-bottom: 10px; display: block; font-weight: bold;}
        textarea { width: 100%; background: rgba(255,255,255,0.05); border: 1px solid var(--border-color); color: var(--text-color); padding: 10px; min-height: 80px; border-radius: 5px; }

        /* Mistake Logger */
        .mistake-controls { display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap;}
        .mistake-select { background: rgba(0,0,0,0.3); color: var(--text-color); border: 1px solid var(--border-color); padding: 5px; border-radius: 5px; }
        .mistake-input { flex: 1; background: rgba(255,255,255,0.05); border: 1px solid var(--border-color); color: var(--text-color); padding: 8px; border-radius: 5px; min-width: 150px; }
        .btn-add-mistake { background: var(--mistake-red); color: white; border: none; padding: 5px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        #mistake-list { margin-top: 10px; max-height: 200px; overflow-y: auto; }
        .mistake-item { background: rgba(255,255,255,0.05); padding: 8px; margin-bottom: 5px; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid #555; }
        .mistake-tag { font-size: 0.75rem; padding: 2px 6px; border-radius: 4px; color: #000; font-weight: bold; margin-right: 8px; text-transform: uppercase;}
        .tag-critical { background: var(--mistake-red); } .tag-medium { background: #ff9f43; } .tag-minor { background: #feca57; }
        .btn-delete { background: #ff6b6b; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; }

        /* MISSION STYLES */
        .mission-section { margin-bottom: 25px; border-left: 3px solid var(--gold-accent); padding-left: 15px; background: rgba(255,255,255,0.03); padding: 15px; border-radius: 0 10px 10px 0; }
        .mission-title { color: var(--peacock-green); font-size: 1.2rem; font-weight: bold; margin-bottom: 10px; text-transform: uppercase; border-bottom: 1px solid #444; padding-bottom: 5px; }
        .mission-text { line-height: 1.6; color: #ddd; font-family: 'Courier New', Courier, monospace; }
        .mission-odia { color: var(--gold-accent); font-weight: bold; font-size: 1.1rem; margin-bottom: 5px; display: block; }

        /* Heatmap */
        .heatmap-container { display: flex; flex-wrap: wrap; gap: 4px; max-width: 800px; margin: 20px auto; justify-content: center; }
        .heatmap-box { width: 12px; height: 12px; border-radius: 2px; background: rgba(255,255,255,0.1); }
        .heat-0 { opacity: 0.3; } .heat-1 { background: var(--peacock-green); opacity: 0.4; } .heat-2 { background: var(--peacock-green); opacity: 0.6; } .heat-3 { background: var(--peacock-green); opacity: 0.8; } .heat-4 { background: var(--peacock-green); opacity: 1; box-shadow: 0 0 5px var(--peacock-green); }

        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; overflow-y: auto; padding: 20px; box-sizing: border-box; }
        .modal-content { max-width: 1000px; margin: 0 auto; background: var(--container-bg); padding: 30px; border-radius: 15px; border: 1px solid var(--peacock-green); color: var(--text-color); }
        .close-btn { float: right; font-size: 2rem; cursor: pointer; color: var(--mistake-red); }
        
        .charts-row { display: flex; flex-wrap: wrap; gap: 20px; margin-top: 20px; }
        .chart-wrapper { flex: 1; min-width: 300px; background: rgba(255,255,255,0.02); border-radius: 10px; padding: 15px; height: 350px; }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px; }
        .stat-card { background: rgba(0,0,0,0.4); border: 1px solid var(--border-color); padding: 15px; border-radius: 8px; text-align: center; }
        .stat-val { font-size: 1.8rem; font-weight: bold; color: var(--peacock-green); }
        .stat-label { color: var(--text-color); opacity: 0.7; font-size: 0.8rem; }

        /* ANALYSIS TABLE */
        .damage-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .damage-table th { background: rgba(255,255,255,0.05); color: var(--gold-accent); padding: 10px; text-align: left; }
        .damage-table td { padding: 10px; border-bottom: 1px solid var(--border-color); vertical-align: top; }
        .suggestion-cell { color: var(--peacock-green); font-style: italic; }

        /* SLOT DETAIL MODAL SPECIFIC */
        #slot-detail-modal .modal-content, #calc-modal .modal-content, #ritual-modal .modal-content, #music-modal .modal-content { max-width: 400px; border: 1px solid var(--gold-accent); }
        .slot-form-group { margin-bottom: 15px; }
        .slot-form-label { display: block; margin-bottom: 5px; color: var(--gold-accent); font-weight: bold; }
        .slot-input { width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid #555; color: white; border-radius: 5px; box-sizing: border-box; }
        .range-wrap { display: flex; align-items: center; gap: 10px; }
        .slot-row-flex { display: flex; gap: 10px; } .half { flex: 1; }
        .warning-text { color: var(--mistake-red); font-size: 0.9rem; margin-top: 5px; animation: flashGold 1s infinite alternate; }

        /* CHECKLIST STYLES */
        .check-item { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px; }
        .check-item input[type="checkbox"] { display: block; width: 20px; height: 20px; margin-right: 10px; accent-color: var(--peacock-green); }
        
        /* MUSIC PLAYER */
        #music-list { max-height: 300px; overflow-y: auto; }
        .music-btn { width: 100%; padding: 12px; margin-bottom: 8px; background: rgba(255, 255, 255, 0.05); border: 1px solid #555; color: var(--text-color); text-align: left; border-radius: 8px; cursor: pointer; transition: 0.2s; display: flex; justify-content: space-between; align-items: center; }
        .music-btn:hover { background: rgba(255, 255, 255, 0.1); border-color: var(--gold-accent); }
        .music-playing { background: var(--peacock-green); color: black; border-color: var(--peacock-green); box-shadow: 0 0 10px var(--peacock-green); }
        .music-category { font-size: 0.8rem; color: #aaa; margin-top: 15px; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid #444; }

        /* Print */
        @media print {
            .top-controls, .cal-btn, .done-click-btn, .detail-btn, .modal, .dashboard-grid, .btn-add-mistake { display: none !important; }
            .container { max-width: 100%; border: none; box-shadow: none; background: white; color: black; }
            .schedule-grid { border: 2px solid #000; }
            * { color: black !important; background: transparent !important; box-shadow: none !important; text-shadow: none !important; }
            .task-input { border-bottom: 1px dotted #000 !important; }
            .time-slot { border-bottom: 1px solid #000 !important; }
        }

/* --- LOGIN INTERFACE STYLES --- */
#login-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000; /* Fallback */
    background: radial-gradient(circle at center, #1a1a2e 0%, #000000 100%);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: transform 0.8s ease-in-out, opacity 0.8s ease-in-out;
}

.login-box {
    background: rgba(20, 20, 40, 0.8);
    padding: 40px;
    border-radius: 20px;
    border: 1px solid var(--gold-accent);
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.1);
    text-align: center;
    width: 350px;
    backdrop-filter: blur(15px);
    animation: fadeInUp 1s ease-out;
    position: relative;
    overflow: hidden;
}

.login-icon {
    font-size: 3rem;
    margin-bottom: 10px;
    animation: float 3s ease-in-out infinite;
}

.login-title {
    color: var(--peacock-green);
    margin: 0;
    letter-spacing: 3px;
    font-size: 1.5rem;
    text-shadow: 0 0 10px var(--peacock-green);
}

.login-sub {
    color: #aaa;
    font-size: 0.8rem;
    margin-bottom: 30px;
    font-family: 'Courier New', monospace;
}

/* Animated Input */
.input-group {
    position: relative;
    margin-bottom: 25px;
}

.input-group input {
    width: 100%;
    padding: 10px 0;
    font-size: 1.2rem;
    color: white;
    background: transparent;
    border: none;
    border-bottom: 2px solid #555;
    outline: none;
    text-align: center;
    transition: 0.3s;
}

.input-group label {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    color: #777;
    transition: 0.3s;
    pointer-events: none;
}

/* Floating Label Effect */
.input-group input:focus ~ label,
.input-group input:not(:placeholder-shown) ~ label {
    top: -20px;
    font-size: 0.8rem;
    color: var(--gold-accent);
}

.input-group input:focus {
    border-bottom-color: var(--gold-accent);
}

/* Laser Scan Effect */
.scan-line {
    position: absolute;
    bottom: 0;
    left: 0;
    height: 2px;
    width: 0%;
    background: var(--gold-accent);
    box-shadow: 0 0 10px var(--gold-accent);
    transition: width 0.3s ease;
}

.input-group input:focus ~ .scan-line {
    width: 100%;
    animation: scan 2s infinite linear; /* Animated scan when focused */
}

@keyframes scan {
    0% { background: var(--gold-accent); box-shadow: 0 0 5px var(--gold-accent); }
    50% { background: var(--peacock-green); box-shadow: 0 0 15px var(--peacock-green); }
    100% { background: var(--gold-accent); box-shadow: 0 0 5px var(--gold-accent); }
}

/* Button */
.login-btn {
    background: transparent;
    border: 1px solid var(--peacock-green);
    color: var(--peacock-green);
    padding: 12px 30px;
    border-radius: 30px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    letter-spacing: 2px;
}

.login-btn:hover {
    background: var(--peacock-green);
    color: black;
    box-shadow: 0 0 20px var(--peacock-green);
}

#login-msg {
    margin-top: 15px;
    height: 20px;
    font-size: 0.9rem;
    font-weight: bold;
}

/* Animations */
@keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
@keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

/* Shake Error */
.shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
@keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }

/* Unlock Transition */
.unlock-success { transform: translateY(-100%); opacity: 0; }
    </style>
</head>
<body class="">

<div id="login-overlay">
    <div class="login-box">
        <div class="login-icon">ğŸ•‰ï¸</div>
        <h2 class="login-title">SYSTEM LOCKED</h2>
        <p class="login-sub">Enter War Room Clearance Code</p>
        
        <div class="input-group">
            <input type="password" id="login-pass" placeholder=" " onkeypress="handleEnter(event)">
            <label>Password</label>
            <div class="scan-line"></div>
        </div>

        <button class="login-btn" onclick="attemptLogin()">UNLOCK SYSTEM</button>
        <div id="login-msg"></div>
    </div>
</div>

<div id="trader-rank" class="rank-badge" style="color: rgb(170, 170, 170); border-color: rgb(170, 170, 170);">ğŸ”° Novice Trader</div>

<div id="mission-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="document.getElementById(&#39;mission-modal&#39;).style.display=&#39;none&#39;">Ã—</span>
        <h1 style="text-align: center; color: var(--gold-accent); border-bottom: 2px solid var(--gold-accent); padding-bottom: 10px;">ğŸ¯ MY ULTIMATE MISSION</h1>
        <p style="text-align: center; font-style: italic; color: #aaa;">"Life is a war and I am the king of this war."</p>

        <div class="mission-section">
            <div class="mission-odia">à¬®à­à¬ à¬à¬• disciplined, calm à¬“ rule-based trader à¬¹à­‡à¬¬à¬¿</div>
            <div class="mission-text">
                I will be a disciplined, calm, and rule-based trader.<br>
                <b>Process &gt; Profit</b> (Process is always ahead of Profit).
            </div>
        </div>
        <div class="mission-section">
            <div class="mission-title">ğŸ§  WHO I AM BECOMING</div>
            <div class="mission-text">
                â€¢ Emotion à¬‰à¬ªà¬°à­‡ control à¬¥à¬¿à¬¬à¬¾ à¬®à¬£à¬¿à¬· (A man who controls emotions).<br>
                â€¢ Loss à¬•à­ lesson à¬­à¬¾à¬¬à­‡ à¬¨à­‡à¬¬à¬¾ warrior (A warrior who takes loss as a lesson).<br>
                â€¢ Noise à¬¨à­à¬¹à­‡à¬, data à¬“ discipline à¬‰à¬ªà¬°à­‡ trust (Trusting data &amp; discipline, not noise).
            </div>
        </div>
        <div class="mission-section">
            <div class="mission-title">âš”ï¸ TRADING GOALS</div>
            <div class="mission-text">
                âœ… Rule follow = Non-negotiable<br>
                âœ… Overtrading = ZERO<br>
                âœ… One setup, one execution<br>
                âœ… Monthly consistency &gt; Daily excitement
            </div>
        </div>
        <div class="mission-section">
            <div class="mission-title">ğŸ’¼ CAREER &amp; MONEY</div>
            <div class="mission-text">
                â€¢ Job + Trading = Balanced life<br>
                â€¢ Debt free life<br>
                â€¢ Capital protection first, growth later<br>
                â€¢ Long term wealth with patience
            </div>
        </div>
        <div class="mission-section">
            <div class="mission-title">ğŸ›¡ï¸ DISCIPLINE RULES (MY LAW)</div>
            <div class="mission-text">
                1. <b>2 SL à¬ªà¬°à­‡ STOP (Stop after 2 Stop Losses)</b><br>
                2. Mental unstable â†’ No trade<br>
                3. Phone control = Focus control<br>
                4. Journal without lie
            </div>
        </div>
        <div class="mission-section">
            <div class="mission-title">ğŸ† CHAMPION PROMISE</div>
            <div class="mission-text" style="color: var(--peacock-green); font-weight: bold; text-align: center; font-size: 1.1rem;">
                â€œWith my time, I must win my strategy at any cost â€” not by luck, but by discipline.â€
            </div>
        </div>
    </div>
</div>

<div id="analysis-modal" class="modal">
    <div class="modal-content" style="max-width: 1000px;">
        <span class="close-btn" onclick="document.getElementById(&#39;analysis-modal&#39;).style.display=&#39;none&#39;">Ã—</span>
        <h2 style="color: var(--peacock-green); margin-top:0;">ğŸ“Š War Room Analytics (Full Spectrum)</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-val" id="modal-daily-score">0%</div>
                <div class="stat-label">Today's Karma</div>
            </div>
            <div class="stat-card">
                <div class="stat-val" id="modal-weekly-score">0%</div>
                <div class="stat-label">Weekly Avg</div>
            </div>
            <div class="stat-card">
                <div class="stat-val" id="modal-profit-sum" style="color: var(--profit-green);">0</div>
                <div class="stat-label">Weekly Net P&amp;L</div>
            </div>
            <div class="stat-card">
                <div class="stat-val" id="modal-jaap-count" style="color: #9966ff;">0</div>
                <div class="stat-label">ğŸ•‰ï¸ Total Naam Jaap</div>
            </div>
            <div class="stat-card">
                <div class="stat-val" id="modal-focus-avg" style="color: var(--gold-accent);">0%</div>
                <div class="stat-label">ğŸ¯ Average Focus</div>
            </div>
            <div class="stat-card">
                <div class="stat-val" id="modal-device-score" style="color: #36a2eb;">0%</div>
                <div class="stat-label">ğŸ’» Laptop Usage</div>
            </div>
            <div class="stat-card">
                <div class="stat-val" id="modal-critical-count" style="color: var(--mistake-red);">0</div>
                <div class="stat-label">Total Mistakes</div>
            </div>
        </div>
        <div class="charts-row">
            <div class="chart-wrapper">
                <h3 style="color: var(--gold-accent); margin-top: 0; font-size:1rem;">ğŸ§  Psychological State (Mood)</h3>
                <canvas id="moodDoughnutChart"></canvas> 
            </div>
            <div class="chart-wrapper">
                <h3 style="color: var(--peacock-green); margin-top: 0; font-size:1rem;">ğŸ¯ Intraday Focus Lock</h3>
                <canvas id="intradayFocusChart"></canvas>
            </div>
        </div>
        <div class="charts-row">
            <div class="chart-wrapper">
                <h3 style="color: #36a2eb; margin-top: 0; font-size:1rem;">ğŸ“± Screen Time Trend</h3>
                <canvas id="screenTimeChart"></canvas>
            </div>
        </div>
        <h3 style="color: var(--mistake-red); border-bottom: 1px solid #444; padding-bottom:5px; margin-top: 30px;">ğŸ›¡ï¸ Battle Damage Assessment</h3>
        <div id="modal-damage-report"></div>
        <div class="charts-row">
            <div class="chart-wrapper">
                <h3 style="color: var(--mistake-red); margin-top: 0; font-size:1rem;">âš ï¸ Mistake Types</h3>
                <canvas id="mistakePieChart"></canvas>
            </div> 
             <div class="chart-wrapper">
                 <h3 style="color: var(--peacock-green); margin-top: 0; font-size:1rem;">ğŸ“ˆ Weekly Discipline Trend</h3>
                 <canvas id="disciplineChart"></canvas>
            </div>
        </div>
        <h3 style="color: var(--gold-accent); text-align:center; margin-top:30px;">ğŸ“… Consistency Heatmap (Year)</h3>
        <div class="heatmap-container" id="yearly-heatmap"></div>
    </div>
</div>

<div id="calc-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="document.getElementById(&#39;calc-modal&#39;).style.display=&#39;none&#39;">Ã—</span>
        <h2 style="color: #3498db; margin-top:0;">ğŸ§® 1% Risk Calculator</h2>
        <div class="slot-form-group"><label class="slot-form-label">Total Capital (â‚¹)</label><input type="number" id="calc-capital" class="slot-input" placeholder="e.g. 100000"></div>
        <div class="slot-form-group"><label class="slot-form-label">Stop Loss (Points)</label><input type="number" id="calc-sl" class="slot-input" placeholder="e.g. 20"></div>
        <div class="slot-form-group"><label class="slot-form-label">Risk Per Trade (%)</label><input type="number" id="calc-risk" class="slot-input" value="1"></div>
        <button class="btn" style="width:100%; background:#3498db; color:white; margin-top:10px;" onclick="calculateRisk()">Calculate Quantity</button>
        <div id="calc-result" style="margin-top:20px; text-align:center; font-size:1.2rem; font-weight:bold; color:var(--gold-accent);"></div>
    </div>
</div>

<div id="music-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="stopAudio(); document.getElementById(&#39;music-modal&#39;).style.display=&#39;none&#39;">Ã—</span>
        <h2 style="color: #9966ff; margin-top:0;">ğŸµ Sonic Nirvana</h2>
        <div style="text-align: center; margin-bottom: 15px;">
            <button class="btn btn-reset" onclick="stopAudio()" style="border-color: #ff4d4d; color: #ff4d4d;">ğŸ›‘ STOP ALL AUDIO</button>
        </div>
        <div id="music-list"><div class="music-category">Spiritual Tones</div><div class="music-btn"><span>ğŸ•‰ï¸ Om Chanting (136.1Hz)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>âœ¨ Miracle Tone (528Hz)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸŒŒ Universal (432Hz)</span><span>â–¶ï¸</span></div><div class="music-category">Brainwave Entrainment</div><div class="music-btn"><span>ğŸ§  Alpha Waves (10Hz - Focus)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸ§˜ Theta Waves (6Hz - Meditate)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸ›Œ Delta Waves (2Hz - Sleep)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>âš¡ Gamma Waves (40Hz - High Perf)</span><span>â–¶ï¸</span></div><div class="music-category">Spiritual Tones</div><div class="music-btn"><span>ğŸ›¡ï¸ Root Chakra (396Hz)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸ§¡ Sacral Chakra (417Hz)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸ”— Connection (639Hz)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸ‘ï¸ Intuition (741Hz)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸ‘‘ Spirit (852Hz)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>âš–ï¸ Divine (963Hz)</span><span>â–¶ï¸</span></div><div class="music-category">Focus Noise</div><div class="music-btn"><span>ğŸŸ¤ Brown Noise (Deep Work)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸŒŠ Pink Noise (Relax)</span><span>â–¶ï¸</span></div><div class="music-category">Brainwave Entrainment</div><div class="music-btn"><span>ğŸª Schumann (7.83Hz)</span><span>â–¶ï¸</span></div><div class="music-category">Spiritual Tones</div><div class="music-btn"><span>ğŸ¦‹ Transformation (Tri 528)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸ•¯ï¸ Monk Drone (100Hz)</span><span>â–¶ï¸</span></div><div class="music-btn"><span>ğŸŒ‘ Void (40Hz Sine)</span><span>â–¶ï¸</span></div><div class="music-category">Focus Noise</div><div class="music-btn"><span>ğŸŒ¬ï¸ White Noise</span><span>â–¶ï¸</span></div></div>
    </div>
</div>

<div id="ritual-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="document.getElementById(&#39;ritual-modal&#39;).style.display=&#39;none&#39;">Ã—</span>
        <h2 style="color: #ff9f43; margin-top:0;">ğŸŒ… Market Rituals</h2>
        <h3 style="color: var(--gold-accent); border-bottom:1px solid #444;">9:00 AM - Pre-Market</h3>
        <div class="check-item"><input type="checkbox"> Global Markets Checked</div>
        <div class="check-item"><input type="checkbox"> Key Levels Marked</div>
        <div class="check-item"><input type="checkbox"> News Checked</div>
        <div class="check-item"><input type="checkbox"> No Mobile on Desk</div>
        <h3 style="color: var(--peacock-green); border-bottom:1px solid #444; margin-top:20px;">3:30 PM - Post-Market</h3>
        <div class="check-item"><input type="checkbox"> All Positions Closed</div>
        <div class="check-item"><input type="checkbox"> Journal Entry Added</div>
    </div>
</div>

<div id="slot-detail-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeSlotDetail()">Ã—</span>
        <h2 style="color: var(--gold-accent); margin-top:0;">ğŸ“ Slot Debrief</h2>
        <div style="color: #aaa; margin-bottom: 15px;" id="slot-detail-time">Time</div>
        <input type="hidden" id="slot-detail-id">
        <div class="slot-row-flex">
            <div class="slot-form-group half">
                <label class="slot-form-label">ğŸ’» Device Used</label>
                <select id="slot-device" class="slot-input" onchange="checkDeviceRule()">
                    <option value="">Select...</option><option value="Laptop">âœ… Laptop</option><option value="Mobile">âŒ Mobile</option>
                </select>
            </div>
            <div class="slot-form-group half">
                <label class="slot-form-label">ğŸ“ Location</label>
                <select id="slot-location" class="slot-input">
                    <option value="">Select...</option><option value="Home">ğŸ  Home</option><option value="Office">ğŸ¢ Office</option><option value="Travel">ğŸš— Travel</option>
                </select>
            </div>
        </div>
        <div id="device-warning" class="warning-text" style="display:none; margin-bottom:10px;">âš ï¸ <b>RULE VIOLATION:</b> No Mobile Trading!</div>
        <div class="slot-form-group"><label class="slot-form-label">ğŸ•‰ï¸ Naam Jaap</label><input type="number" id="slot-jaap" class="slot-input" placeholder="0"></div>
        <div class="slot-form-group"><label class="slot-form-label">ğŸ¯ Focus Level (<span id="focus-val">50</span>%)</label><div class="range-wrap"><span>0%</span><input type="range" id="slot-focus" class="slot-input" min="0" max="100" step="10" oninput="document.getElementById(&#39;focus-val&#39;).innerText=this.value"><span>100%</span></div></div>
        <div class="slot-form-group"><label class="slot-form-label">ğŸ§  Mood</label><select id="slot-mood" class="slot-input" style="background:#222;"><option value="">Select...</option><option value="Calm">ğŸ§˜ Calm</option><option value="Focused">ğŸ¯ Focused</option><option value="Aggressive">ğŸ”¥ Aggressive</option><option value="Distracted">ğŸŒ«ï¸ Distracted</option><option value="Anxious">ğŸ˜° Anxious</option><option value="Happy">ğŸ˜Š Happy</option></select></div>
        <div class="slot-form-group"><label class="slot-form-label">ğŸ“ Feeling</label><textarea id="slot-feeling" class="slot-input" rows="3"></textarea></div>
        <button class="btn" style="width:100%; background:var(--gold-accent); color:black;" onclick="saveSlotDetail()">ğŸ’¾ Save Log</button>
    </div>
</div>

<div id="category-modal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
        <span class="close-btn" onclick="toggleModal(&#39;category-modal&#39;)">Ã—</span>
        <h2 style="color: var(--gold-accent);">âš™ï¸ Manage Categories</h2>
        <div id="cat-list-container"></div>
        <button class="btn" style="width:100%; margin-top:10px; background:var(--peacock-green); color:black;" onclick="addNewCategory()">+ Add Category</button>
        <button class="btn" style="width:100%; margin-top:10px;" onclick="toggleModal(&#39;category-modal&#39;); refreshView();">Done &amp; Reload</button>
        <div style="margin-top: 30px; border-top: 1px solid #444; padding-top: 20px;">
            <button class="btn" style="width:100%; border-color:var(--mistake-red); color:var(--mistake-red);" onclick="factoryReset()">âš ï¸ Factory Reset (Delete All Data)</button>
        </div>
    </div>
</div>

<div class="container">
    <header>
        <div class="user-name">ğŸ‘¤ Commander: Daimond Mahanta</div>
        <div class="odia-quote">
            à¬œà­€à¬¬à¬¨ à¬à¬• à¬¯à­à¬¦à­à¬§ à¬†à¬‰ à¬à¬¹à¬¿ à¬¯à­à¬¦à­à¬§à¬° à¬°à¬¾à¬œà¬¾ à¬®à­à¬, <br>
            à¬®à­‹ à¬¸à¬®à­Ÿ à¬¸à¬¹à¬¿à¬¤ à¬®à­‹ à¬°à¬£à¬¨à­€à¬¤à¬¿à¬•à­ à¬®à­‹à¬¤à­‡ à¬¹à¬° à¬¹à¬¾à¬²à­â€Œà¬°à­‡ à¬œà¬¿à¬¤à¬¿à¬¬à¬¾à¬° à¬…à¬›à¬¿ à¥¤
        </div>
        <div class="eng-subtitle">
            "Life is a war and I am the king of this war. With my time, I must win my strategy/plan at any cost."
        </div>
    </header>

    <div class="top-controls">
        <div class="date-nav">
            <button class="btn" onclick="changeDate(-1)">â®</button>
            <input type="date" id="date-picker" onchange="loadDate(this.value)">
            <button class="btn" onclick="changeDate(1)">â¯</button>
        </div>
        <div>
            <select id="shift-select" class="shift-select" onchange="applyShift()">
                <option value="">ğŸ‘” Select Shift</option>
                <option value="morning">ğŸŒ… Morning (A): 06-16</option>
                <option value="general">â˜€ï¸ General (G): 08-18</option>
                <option value="second">ğŸ•‘ Second (B): 12-22</option>
                <option value="night">ğŸŒ™ Night (C): 21:30-07</option>
            </select>
            <button class="btn btn-mission" onclick="document.getElementById(&#39;mission-modal&#39;).style.display=&#39;block&#39;">ğŸ¯ Mission</button>
            <button class="btn btn-music" onclick="document.getElementById(&#39;music-modal&#39;).style.display=&#39;block&#39;">ğŸµ Music</button>
            <button class="btn btn-ritual" onclick="document.getElementById(&#39;ritual-modal&#39;).style.display=&#39;block&#39;">ğŸŒ… Rituals</button>
            <button class="btn btn-calc" onclick="document.getElementById(&#39;calc-modal&#39;).style.display=&#39;block&#39;">ğŸ§® Calc</button>
            <button class="btn" id="theme-btn" onclick="cycleTheme()">ğŸ¨ Theme: Divine</button>
            <button class="btn" onclick="toggleModal(&#39;category-modal&#39;)">âš™ï¸ Cats</button>
            <button class="btn btn-analyze" onclick="runDetailedAnalysis()">ğŸ“Š War Room</button>
            <button class="btn" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        </div>
    </div>

    <div class="dashboard-grid">
        <div class="score-board">
            <div>
                <div class="score-label">Result</div>
                <div id="day-result-badge" class="result-stamp stamp-neutral">N/A</div>
            </div>
            <div>
                <div class="score-label">Karma Score</div>
                <div id="daily-score" class="score-val">0%</div>
            </div>
            <div>
                <div class="score-label">Tasks Done</div>
                <div id="task-count" class="score-val" style="font-size: 1.5rem; color:var(--text-color);">0/0</div>
            </div>
            <div>
                <div class="score-label" style="color:var(--mistake-red)">Errors</div>
                <div id="dash-critical-count" class="score-val" style="font-size: 1.5rem; color:var(--mistake-red)">0</div>
            </div>
        </div>
        
        <div class="brahmacharya-board" id="brahmacharya-box" style="border-color: var(--saffron);">
            <div class="streak-val" id="brahmacharya-streak">0</div>
            <div class="streak-label">ğŸ›¡ï¸ Days of Brahmacharya (Ojas)</div>
            <div id="brahmacharya-actions" style="margin-top: 10px; display: block;">
                <div style="font-size: 0.8rem; margin-bottom: 5px; color: #aaa;">Did you maintain Purity today?</div>
                <button class="btn btn-yes" onclick="confirmBrahmacharya(true)">âœ… Yes</button>
                <button class="btn btn-no" onclick="confirmBrahmacharya(false)">âŒ No</button>
            </div>
            <div id="brahmacharya-status" class="brahmacharya-status-text" style="display: none; color: var(--peacock-green);">âœ¨ Pure Today</div>
        </div>

        <div class="pnl-board">
            <div class="score-label">Daily P&amp;L (â‚¹)</div>
            <input type="number" id="daily-pnl" class="pnl-input" placeholder="0.00" onchange="savePnL()">
            <select id="daily-mindset" class="mindset-select" onchange="savePnL()">
                <option value="">Mindset?</option>
                <option value="calm">ğŸ§˜ Calm</option>
                <option value="fomo">ğŸ˜¨ FOMO (FAIL)</option>
                <option value="greed">ğŸ¤‘ Greed (FAIL)</option>
                <option value="revenge">ğŸ˜¡ Revenge (FAIL)</option>
                <option value="fear">ğŸ¥¶ Fear</option>
            </select>
        </div>

        <div class="screen-time-board" id="screen-time-box" style="border-color: rgb(54, 162, 235);">
            <div class="score-label">ğŸ“± Digital Wellbeing</div>
            <div class="screen-inputs">
                <input type="number" id="screentime-h" class="screen-input-small" placeholder="Hr" onchange="saveScreenTime()">
                <span>:</span>
                <input type="number" id="screentime-m" class="screen-input-small" placeholder="Min" onchange="saveScreenTime()">
            </div>
            <div id="screen-status" style="font-size: 0.7rem; margin-top: 5px; color: rgb(170, 170, 170);">Log total phone time</div>
        </div>
    </div>

    <div id="schedule-container" class="schedule-grid"><div class="time-slot"><div class="time-label">12:00 AM</div><input type="checkbox" id="check_2025-12-27_0-0"><select class="cat-select" id="cat_2025-12-27_0-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_0-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">12:30 AM</div><input type="checkbox" id="check_2025-12-27_0-30"><select class="cat-select" id="cat_2025-12-27_0-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_0-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">1:00 AM</div><input type="checkbox" id="check_2025-12-27_1-0"><select class="cat-select" id="cat_2025-12-27_1-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_1-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">1:30 AM</div><input type="checkbox" id="check_2025-12-27_1-30"><select class="cat-select" id="cat_2025-12-27_1-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_1-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">2:00 AM</div><input type="checkbox" id="check_2025-12-27_2-0"><select class="cat-select" id="cat_2025-12-27_2-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_2-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">2:30 AM</div><input type="checkbox" id="check_2025-12-27_2-30"><select class="cat-select" id="cat_2025-12-27_2-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_2-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">3:00 AM</div><input type="checkbox" id="check_2025-12-27_3-0"><select class="cat-select" id="cat_2025-12-27_3-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_3-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">3:30 AM</div><input type="checkbox" id="check_2025-12-27_3-30"><select class="cat-select" id="cat_2025-12-27_3-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_3-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">4:00 AM</div><input type="checkbox" id="check_2025-12-27_4-0"><select class="cat-select" id="cat_2025-12-27_4-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_4-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">4:30 AM</div><input type="checkbox" id="check_2025-12-27_4-30"><select class="cat-select" id="cat_2025-12-27_4-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_4-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">5:00 AM</div><input type="checkbox" id="check_2025-12-27_5-0"><select class="cat-select" id="cat_2025-12-27_5-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_5-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">5:30 AM</div><input type="checkbox" id="check_2025-12-27_5-30"><select class="cat-select" id="cat_2025-12-27_5-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_5-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">6:00 AM</div><input type="checkbox" id="check_2025-12-27_6-0"><select class="cat-select" id="cat_2025-12-27_6-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_6-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">6:30 AM</div><input type="checkbox" id="check_2025-12-27_6-30"><select class="cat-select" id="cat_2025-12-27_6-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_6-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">7:00 AM</div><input type="checkbox" id="check_2025-12-27_7-0"><select class="cat-select" id="cat_2025-12-27_7-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_7-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">7:30 AM</div><input type="checkbox" id="check_2025-12-27_7-30"><select class="cat-select" id="cat_2025-12-27_7-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_7-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">8:00 AM</div><input type="checkbox" id="check_2025-12-27_8-0"><select class="cat-select" id="cat_2025-12-27_8-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_8-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">8:30 AM</div><input type="checkbox" id="check_2025-12-27_8-30"><select class="cat-select" id="cat_2025-12-27_8-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_8-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">9:00 AM</div><input type="checkbox" id="check_2025-12-27_9-0"><select class="cat-select" id="cat_2025-12-27_9-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_9-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">9:30 AM</div><input type="checkbox" id="check_2025-12-27_9-30"><select class="cat-select" id="cat_2025-12-27_9-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_9-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">10:00 AM</div><input type="checkbox" id="check_2025-12-27_10-0"><select class="cat-select" id="cat_2025-12-27_10-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_10-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">10:30 AM</div><input type="checkbox" id="check_2025-12-27_10-30"><select class="cat-select" id="cat_2025-12-27_10-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_10-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">11:00 AM</div><input type="checkbox" id="check_2025-12-27_11-0"><select class="cat-select" id="cat_2025-12-27_11-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_11-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">11:30 AM</div><input type="checkbox" id="check_2025-12-27_11-30"><select class="cat-select" id="cat_2025-12-27_11-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_11-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">12:00 PM</div><input type="checkbox" id="check_2025-12-27_12-0"><select class="cat-select" id="cat_2025-12-27_12-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_12-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">12:30 PM</div><input type="checkbox" id="check_2025-12-27_12-30"><select class="cat-select" id="cat_2025-12-27_12-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_12-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">1:00 PM</div><input type="checkbox" id="check_2025-12-27_13-0"><select class="cat-select" id="cat_2025-12-27_13-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_13-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">1:30 PM</div><input type="checkbox" id="check_2025-12-27_13-30"><select class="cat-select" id="cat_2025-12-27_13-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_13-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">2:00 PM</div><input type="checkbox" id="check_2025-12-27_14-0"><select class="cat-select" id="cat_2025-12-27_14-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_14-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">2:30 PM</div><input type="checkbox" id="check_2025-12-27_14-30"><select class="cat-select" id="cat_2025-12-27_14-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_14-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">3:00 PM</div><input type="checkbox" id="check_2025-12-27_15-0"><select class="cat-select" id="cat_2025-12-27_15-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_15-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">3:30 PM</div><input type="checkbox" id="check_2025-12-27_15-30"><select class="cat-select" id="cat_2025-12-27_15-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_15-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">4:00 PM</div><input type="checkbox" id="check_2025-12-27_16-0"><select class="cat-select" id="cat_2025-12-27_16-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_16-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">4:30 PM</div><input type="checkbox" id="check_2025-12-27_16-30"><select class="cat-select" id="cat_2025-12-27_16-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_16-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">5:00 PM</div><input type="checkbox" id="check_2025-12-27_17-0"><select class="cat-select" id="cat_2025-12-27_17-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_17-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">5:30 PM</div><input type="checkbox" id="check_2025-12-27_17-30"><select class="cat-select" id="cat_2025-12-27_17-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_17-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">6:00 PM</div><input type="checkbox" id="check_2025-12-27_18-0"><select class="cat-select" id="cat_2025-12-27_18-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_18-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">6:30 PM</div><input type="checkbox" id="check_2025-12-27_18-30"><select class="cat-select" id="cat_2025-12-27_18-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_18-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">7:00 PM</div><input type="checkbox" id="check_2025-12-27_19-0"><select class="cat-select" id="cat_2025-12-27_19-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_19-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">7:30 PM</div><input type="checkbox" id="check_2025-12-27_19-30"><select class="cat-select" id="cat_2025-12-27_19-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_19-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">8:00 PM</div><input type="checkbox" id="check_2025-12-27_20-0"><select class="cat-select" id="cat_2025-12-27_20-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_20-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">8:30 PM</div><input type="checkbox" id="check_2025-12-27_20-30"><select class="cat-select" id="cat_2025-12-27_20-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_20-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">9:00 PM</div><input type="checkbox" id="check_2025-12-27_21-0"><select class="cat-select" id="cat_2025-12-27_21-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_21-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">9:30 PM</div><input type="checkbox" id="check_2025-12-27_21-30"><select class="cat-select" id="cat_2025-12-27_21-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_21-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">10:00 PM</div><input type="checkbox" id="check_2025-12-27_22-0"><select class="cat-select" id="cat_2025-12-27_22-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_22-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">10:30 PM</div><input type="checkbox" id="check_2025-12-27_22-30"><select class="cat-select" id="cat_2025-12-27_22-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_22-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">11:00 PM</div><input type="checkbox" id="check_2025-12-27_23-0"><select class="cat-select" id="cat_2025-12-27_23-0"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_23-0"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div><div class="time-slot"><div class="time-label">11:30 PM</div><input type="checkbox" id="check_2025-12-27_23-30"><select class="cat-select" id="cat_2025-12-27_23-30"><option value="work">ğŸ’¼</option><option value="study">ğŸ“š</option><option value="health">ğŸ’ª</option><option value="spiritual">ğŸ•‰ï¸</option></select><input type="text" class="task-input" id="task_2025-12-27_23-30"><div class="action-group"><button class="detail-btn">ğŸ“</button><button class="cal-btn">ğŸ“…</button><button class="done-click-btn"></button></div></div></div>

    <div class="reflections">
        <div class="reflection-box">
            <span class="reflection-title" style="color:var(--mistake-red)">âš ï¸ Tactical Errors Log</span>
            <div class="mistake-controls">
                <select id="mistake-severity" class="mistake-select">
                    <option value="critical">ğŸ”´ Critical (FAIL)</option>
                    <option value="medium">ğŸŸ  Medium</option>
                    <option value="minor">ğŸŸ¡ Minor</option>
                </select>
                <input type="text" id="mistake-desc" class="mistake-input" placeholder="Mistake Name (e.g. FOMO)...">
                <input type="text" id="mistake-fix" class="mistake-input" placeholder="Correction Plan (Optional)...">
                <button class="btn-add-mistake" onclick="addMistake()">Add Log</button>
            </div>
            <div id="mistake-list"></div>
        </div>

        <div class="reflection-box">
            <span class="reflection-title">âœ¨ Good 3 Things</span>
            <textarea id="good-things" oninput="saveReflection(&#39;good-things&#39;)"></textarea>
        </div>
        <div class="reflection-box full-width">
            <span class="reflection-title">ğŸ’¡ War Room Debrief (Learning)</span>
            <textarea id="learning" oninput="saveReflection(&#39;learning&#39;)"></textarea>
        </div>
    </div>
</div>

<script>
    let currentDate = new Date();
    window.divineCharts = {}; // Global chart store
    
    // --- AUDIO ENGINE ---
    let audioContext = null;
    let activeOscillators = [];
    
    const PRESETS = [
        { name: "ğŸ•‰ï¸ Om Chanting (136.1Hz)", type: 'tone', freq: 136.1 },
        { name: "âœ¨ Miracle Tone (528Hz)", type: 'tone', freq: 528 },
        { name: "ğŸŒŒ Universal (432Hz)", type: 'tone', freq: 432 },
        { name: "ğŸ§  Alpha Waves (10Hz - Focus)", type: 'binaural', base: 432, beat: 10 },
        { name: "ğŸ§˜ Theta Waves (6Hz - Meditate)", type: 'binaural', base: 136.1, beat: 6 },
        { name: "ğŸ›Œ Delta Waves (2Hz - Sleep)", type: 'binaural', base: 100, beat: 2 },
        { name: "âš¡ Gamma Waves (40Hz - High Perf)", type: 'binaural', base: 432, beat: 40 },
        { name: "ğŸ›¡ï¸ Root Chakra (396Hz)", type: 'tone', freq: 396 },
        { name: "ğŸ§¡ Sacral Chakra (417Hz)", type: 'tone', freq: 417 },
        { name: "ğŸ”— Connection (639Hz)", type: 'tone', freq: 639 },
        { name: "ğŸ‘ï¸ Intuition (741Hz)", type: 'tone', freq: 741 },
        { name: "ğŸ‘‘ Spirit (852Hz)", type: 'tone', freq: 852 },
        { name: "âš–ï¸ Divine (963Hz)", type: 'tone', freq: 963 },
        { name: "ğŸŸ¤ Brown Noise (Deep Work)", type: 'noise', color: 'brown' },
        { name: "ğŸŒŠ Pink Noise (Relax)", type: 'noise', color: 'pink' },
        { name: "ğŸª Schumann (7.83Hz)", type: 'binaural', base: 136.1, beat: 7.83 },
        { name: "ğŸ¦‹ Transformation (Tri 528)", type: 'tone', freq: 528, wave: 'triangle' },
        { name: "ğŸ•¯ï¸ Monk Drone (100Hz)", type: 'tone', freq: 100, wave: 'sawtooth' },
        { name: "ğŸŒ‘ Void (40Hz Sine)", type: 'tone', freq: 40 },
        { name: "ğŸŒ¬ï¸ White Noise", type: 'noise', color: 'white' }
    ];

    function initAudio() {
        if (!audioContext) {
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            audioContext = new AudioContext();
        }
        if(audioContext.state === 'suspended') audioContext.resume();
    }

    function stopAudio() {
        activeOscillators.forEach(node => {
            try { node.stop(); } catch(e){}
            try { node.disconnect(); } catch(e){}
        });
        activeOscillators = [];
    }

    function playPreset(index) {
        initAudio();
        stopAudio();
        const p = PRESETS[index];
        const gain = audioContext.createGain();
        gain.gain.value = 0.1; // Low volume
        gain.connect(audioContext.destination);

        if (p.type === 'tone') {
            const osc = audioContext.createOscillator();
            osc.type = p.wave || 'sine';
            osc.frequency.value = p.freq;
            osc.connect(gain);
            osc.start();
            activeOscillators.push(osc);
        } else if (p.type === 'binaural') {
            const merger = audioContext.createChannelMerger(2);
            const left = audioContext.createOscillator();
            left.frequency.value = p.base;
            left.connect(merger, 0, 0); 
            const right = audioContext.createOscillator();
            right.frequency.value = p.base + p.beat;
            right.connect(merger, 0, 1); 
            merger.connect(gain);
            left.start(); right.start();
            activeOscillators.push(left, right);
        } else if (p.type === 'noise') {
            const bufferSize = audioContext.sampleRate * 2;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < bufferSize; i++) {
                const white = Math.random() * 2 - 1;
                data[i] = (p.color === 'white') ? white : (Math.random() * 2 - 1) * 0.5; // Simplified noise
            }
            const noise = audioContext.createBufferSource();
            noise.buffer = buffer;
            noise.loop = true;
            noise.connect(gain);
            noise.start();
            activeOscillators.push(noise);
        }
    }

    // --- RENDER MUSIC LIST ---
    function renderMusicList() {
        const list = document.getElementById('music-list');
        list.innerHTML = '';
        let lastType = '';
        PRESETS.forEach((p, idx) => {
            if(p.type !== lastType) {
                const cat = document.createElement('div');
                cat.className = 'music-category';
                cat.textContent = p.type === 'tone' ? 'Spiritual Tones' : p.type === 'binaural' ? 'Brainwave Entrainment' : 'Focus Noise';
                list.appendChild(cat);
                lastType = p.type;
            }
            const btn = document.createElement('div');
            btn.className = 'music-btn';
            btn.innerHTML = `<span>${p.name}</span><span>â–¶ï¸</span>`;
            btn.onclick = () => {
                document.querySelectorAll('.music-btn').forEach(b => b.classList.remove('music-playing'));
                btn.classList.add('music-playing');
                playPreset(idx);
            };
            list.appendChild(btn);
        });
    }

    // --- FACTORY RESET ---
    function factoryReset() {
        if(confirm("âš ï¸ DANGER: This will delete ALL data (History, Tasks, P&L, Streaks). Are you sure?")) {
            if(confirm("Final Warning: This cannot be undone.")) {
                localStorage.clear();
                location.reload();
            }
        }
    }

    // --- SCREEN TIME LOGIC ---
    function saveScreenTime() {
        const h = document.getElementById('screentime-h').value || 0;
        const m = document.getElementById('screentime-m').value || 0;
        const totalMins = (parseInt(h) * 60) + parseInt(m);
        const key = `screen_time_${formatDateKey(currentDate)}`;
        localStorage.setItem(key, totalMins);
        updateScreenTimeUI(totalMins);
    }

    function loadScreenTime() {
        const key = `screen_time_${formatDateKey(currentDate)}`;
        const totalMins = localStorage.getItem(key);
        if(totalMins) {
            const h = Math.floor(totalMins / 60);
            const m = totalMins % 60;
            document.getElementById('screentime-h').value = h;
            document.getElementById('screentime-m').value = m;
            updateScreenTimeUI(totalMins);
        } else {
            document.getElementById('screentime-h').value = '';
            document.getElementById('screentime-m').value = '';
            updateScreenTimeUI(0);
        }
    }

    function updateScreenTimeUI(mins) {
        const box = document.getElementById('screen-time-box');
        const status = document.getElementById('screen-status');
        if(mins == 0) {
            box.style.borderColor = "#36a2eb";
            status.innerHTML = "Log total phone time";
            status.style.color = "#aaa";
        } else if (mins < 120) { // < 2 hours
            box.style.borderColor = "var(--peacock-green)";
            status.innerHTML = "ğŸŸ¢ Excellent Control";
            status.style.color = "var(--peacock-green)";
        } else if (mins < 240) { // < 4 hours
            box.style.borderColor = "orange";
            status.innerHTML = "ğŸŸ  Warning Zone";
            status.style.color = "orange";
        } else { // > 4 hours
            box.style.borderColor = "var(--mistake-red)";
            status.innerHTML = "ğŸ”´ High Dopamine!";
            status.style.color = "var(--mistake-red)";
        }
    }

    // --- SHIFT LOGIC ---
    function applyShift() {
        const shift = document.getElementById('shift-select').value;
        if (!shift) return;

        const dateKey = formatDateKey(currentDate);
        if(!confirm("Auto-fill schedule for " + shift + " shift? Existing tasks in these slots will be overwritten.")) return;

        let workStartH, workStartM, commuteStartH, commuteStartM, workDurationSlots = 18; 
        if (shift === 'morning') { workStartH = 7; workStartM = 0; commuteStartH = 6; commuteStartM = 0; }
        else if (shift === 'general') { workStartH = 9; workStartM = 0; commuteStartH = 8; commuteStartM = 0; }
        else if (shift === 'second') { workStartH = 13; workStartM = 0; commuteStartH = 12; commuteStartM = 0; }
        else if (shift === 'night') { workStartH = 22; workStartM = 0; commuteStartH = 21; commuteStartM = 30; }

        let commuteSlots = (shift === 'night') ? 1 : 2; 
        let startIdx = (commuteStartH * 2) + (commuteStartM / 30);
        
        for (let i = 0; i < commuteSlots; i++) {
            let idx = startIdx + i;
            let h = Math.floor(idx / 2);
            let m = (idx % 2) * 30;
            saveTask(dateKey, h, m, "ğŸš— Travel to Office", "other");
        }

        let workIdx = (workStartH * 2) + (workStartM / 30);
        for (let i = 0; i < workDurationSlots; i++) {
            let idx = workIdx + i;
            if (idx > 47) break; 
            let h = Math.floor(idx / 2);
            let m = (idx % 2) * 30;
            saveTask(dateKey, h, m, "ğŸ’¼ Office Work", "work");
            let detailKey = `detail_${dateKey}_${h}-${m}`;
            let detail = JSON.parse(localStorage.getItem(detailKey) || "{}");
            detail.location = "Office";
            localStorage.setItem(detailKey, JSON.stringify(detail));
        }

        renderSchedule();
        alert("Shift Schedule Applied! ğŸš€");
        document.getElementById('shift-select').value = ""; 
    }

    function saveTask(dateKey, h, m, text, cat) {
        let slotId = `task_${dateKey}_${h}-${m}`;
        let catId = `cat_${dateKey}_${h}-${m}`;
        localStorage.setItem(slotId, text);
        localStorage.setItem(catId, cat);
    }

    // --- SMART ADVISOR LOGIC ---
    const tradingTips = {
        "fomo": "Wait for candle close. No signal = No trade.",
        "revenge": "STOP TRADING NOW. Preserve capital.",
        "early": "Trust your stop loss and target.",
        "overtrading": "Limit to 2 trades/day.",
        "rule": "Read your checklist before entering.",
        "stop": "Always respect SL.",
        "greed": "Book profits at levels.",
        "relapse": "Ojas lost. Perform Pranayama. Reset and restart.",
        "mobile": "Mobile screen hides details. Use Laptop for analysis."
    };

    function getSmartSuggestion(text) {
        const lower = text.toLowerCase();
        for (const [key, tip] of Object.entries(tradingTips)) {
            if (lower.includes(key)) return `ğŸ¤– <b>Tactical Advice:</b> ${tip}`;
        }
        return "ğŸ¤– <b>Advice:</b> Review rules.";
    }

    // --- THEME LOGIC ---
    const themes = ['', 'theme-warzone', 'theme-matrix', 'theme-zen'];
    const themeNames = ['Divine', 'Warzone', 'Matrix', 'Zen'];
    let currentThemeIndex = 0;

    function initTheme() {
        const saved = localStorage.getItem('divine_theme_idx');
        if(saved) currentThemeIndex = parseInt(saved);
        applyTheme();
    }
    function cycleTheme() {
        currentThemeIndex = (currentThemeIndex + 1) % themes.length;
        localStorage.setItem('divine_theme_idx', currentThemeIndex);
        applyTheme();
    }
    function applyTheme() {
        document.body.className = themes[currentThemeIndex];
        document.getElementById('theme-btn').textContent = `ğŸ¨ Theme: ${themeNames[currentThemeIndex]}`;
    }

    // --- DATA & INIT ---
    const defaultCategories = {
        'work': { label: 'Trading', emoji: 'ğŸ’¼', color: '#36a2eb' },
        'study': { label: 'Learning', emoji: 'ğŸ“š', color: '#ffcd56' },
        'health': { label: 'Health', emoji: 'ğŸ’ª', color: '#4bc0c0' },
        'spiritual': { label: 'Spirit', emoji: 'ğŸ•‰ï¸', color: '#9966ff' }
    };
    let categories = {};

    function init() {
        const savedCats = localStorage.getItem('divine_categories');
        if (savedCats) categories = JSON.parse(savedCats);
        else { categories = JSON.parse(JSON.stringify(defaultCategories)); saveCategories(); }
        document.getElementById('date-picker').value = formatDateKey(currentDate);
        initTheme();
        renderMusicList(); // Initialize Music
        refreshView();
        updateBrahmacharyaUI();
    }
    
    function formatDateKey(date) {
        const y = date.getFullYear();
        const m = String(date.getMonth() + 1).padStart(2, '0');
        const d = String(date.getDate()).padStart(2, '0');
        return `${y}-${m}-${d}`;
    }
    
    function changeDate(days) { 
        currentDate.setDate(currentDate.getDate() + days); 
        document.getElementById('date-picker').value = formatDateKey(currentDate); 
        refreshView(); 
        updateBrahmacharyaUI(); 
    }
    function loadDate(dateString) { 
        if(!dateString) return; 
        currentDate = new Date(dateString); 
        refreshView(); 
        updateBrahmacharyaUI(); 
    }
    function saveCategories() { localStorage.setItem('divine_categories', JSON.stringify(categories)); }

    function refreshView() { 
        renderSchedule(); 
        loadReflections(); 
        renderMistakes();
        loadPnL();
        loadScreenTime(); 
        calculateScore(); 
        updateRank();
    }

    // --- RANK LOGIC ---
    function updateRank() {
        let sum = 0, count = 0;
        for(let i=0; i<7; i++) {
            const d = new Date(); d.setDate(d.getDate() - i);
            const s = localStorage.getItem(`score_${formatDateKey(d)}`);
            if(s) { sum += parseInt(s); count++; }
        }
        const avg = count ? Math.round(sum/count) : 0;
        let rank = "ğŸ”° Novice Trader";
        let color = "#aaa";
        if(avg > 50) { rank = "âš”ï¸ Soldier"; color = "#3498db"; }
        if(avg > 70) { rank = "ğŸ–ï¸ Commander"; color = "#ff9f43"; }
        if(avg > 85) { rank = "ğŸ‘‘ Market Wizard"; color = "#ffd700"; }
        
        const badge = document.getElementById('trader-rank');
        badge.textContent = rank;
        badge.style.color = color;
        badge.style.borderColor = color;
    }

    // --- RISK CALCULATOR ---
    function calculateRisk() {
        const capital = parseFloat(document.getElementById('calc-capital').value);
        const sl = parseFloat(document.getElementById('calc-sl').value);
        const riskPer = parseFloat(document.getElementById('calc-risk').value);
        
        if(!capital || !sl || !riskPer) return;
        
        const riskAmount = (capital * riskPer) / 100;
        const qty = Math.floor(riskAmount / sl);
        
        document.getElementById('calc-result').innerHTML = `Risk: â‚¹${riskAmount}<br>Quantity: <span style="font-size:1.5em; color:white;">${qty}</span>`;
    }

    // --- BRAHMACHARYA LOGIC (YES/NO) ---
    function updateBrahmacharyaUI() {
        const startStr = localStorage.getItem('brahmacharya_start');
        let streak = 0;
        if(startStr) {
            const start = new Date(startStr);
            const now = new Date();
            const diff = now - start;
            streak = Math.floor(diff / (1000 * 60 * 60 * 24));
        }
        document.getElementById('brahmacharya-streak').textContent = streak;

        const todayKey = formatDateKey(currentDate);
        const lastCheck = localStorage.getItem('brahmacharya_check_' + todayKey);
        
        const actions = document.getElementById('brahmacharya-actions');
        const status = document.getElementById('brahmacharya-status');
        const board = document.getElementById('brahmacharya-box');

        if(lastCheck === 'yes') {
            actions.style.display = 'none';
            status.style.display = 'block';
            status.innerHTML = "âœ¨ Pure Today";
            status.style.color = "var(--peacock-green)";
            board.style.borderColor = "var(--peacock-green)";
        } else if (lastCheck === 'no') {
            actions.style.display = 'none';
            status.style.display = 'block';
            status.innerHTML = "âš ï¸ Relapsed";
            status.style.color = "var(--mistake-red)";
            board.style.borderColor = "var(--mistake-red)";
        } else {
            actions.style.display = 'block';
            status.style.display = 'none';
            board.style.borderColor = "var(--saffron)";
        }
    }

    function confirmBrahmacharya(success) {
        const todayKey = formatDateKey(currentDate);
        if (success) {
            localStorage.setItem('brahmacharya_check_' + todayKey, 'yes');
            playDivineSound();
            explodeConfetti(window.innerWidth / 2, window.innerHeight / 2);
            if(!localStorage.getItem('brahmacharya_start')) {
                localStorage.setItem('brahmacharya_start', new Date().toISOString());
            }
        } else {
            if(!confirm("Confirm Relapse? This will reset your streak.")) return;
            localStorage.setItem('brahmacharya_check_' + todayKey, 'no');
            localStorage.setItem('brahmacharya_start', new Date().toISOString()); 
            
            const key = getMistakeKey();
            let mistakes = JSON.parse(localStorage.getItem(key) || "[]");
            mistakes.push({ id: Date.now(), severity: 'critical', desc: 'Relapse (Brahmacharya Break)', fix: 'Pranayama & Cold Shower' });
            localStorage.setItem(key, JSON.stringify(mistakes));
            renderMistakes();
            calculateScore();
        }
        updateBrahmacharyaUI();
    }

    // --- MAIN RENDERER ---
    function renderSchedule() {
        const container = document.getElementById('schedule-container');
        container.innerHTML = '';
        const interval = 30;
        const dateKey = formatDateKey(currentDate);

        for (let time = 0; time < 24 * 60; time += interval) {
            let hours = Math.floor(time / 60); let minutes = time % 60;
            let timeString = `${hours % 12 || 12}:${minutes < 10 ? '0' + minutes : minutes} ${hours >= 12 ? 'PM' : 'AM'}`;
            let slotId = `task_${dateKey}_${hours}-${minutes}`;
            let checkId = `check_${dateKey}_${hours}-${minutes}`;
            let catId = `cat_${dateKey}_${hours}-${minutes}`;
            let detailId = `detail_${dateKey}_${hours}-${minutes}`;

            const row = document.createElement('div'); row.className = 'time-slot';
            
            const checkbox = document.createElement('input'); checkbox.type = 'checkbox';
            checkbox.id = checkId; checkbox.checked = localStorage.getItem(checkId) === 'true';

            const select = document.createElement('select'); select.className = 'cat-select'; select.id = catId;
            for (const [key, val] of Object.entries(categories)) {
                let opt = document.createElement('option'); opt.value = key; opt.textContent = val.emoji; select.appendChild(opt);
            }
            select.value = (localStorage.getItem(catId) && categories[localStorage.getItem(catId)]) ? localStorage.getItem(catId) : Object.keys(categories)[0];
            select.addEventListener('change', (e) => localStorage.setItem(catId, e.target.value));

            const input = document.createElement('input'); input.type = 'text'; input.className = 'task-input'; input.id = slotId;
            input.value = localStorage.getItem(slotId) || '';
            if (checkbox.checked) input.classList.add('task-done');
            input.addEventListener('input', (e) => { localStorage.setItem(slotId, e.target.value); calculateScore(); });
            
            // ACTIONS
            const actionGroup = document.createElement('div'); actionGroup.className = 'action-group';

            // Detail Button
            const hasDetail = localStorage.getItem(detailId);
            const detailBtn = document.createElement('button'); 
            detailBtn.className = 'detail-btn'; 
            detailBtn.innerHTML = 'ğŸ“';
            if(hasDetail) detailBtn.classList.add('detail-active');
            detailBtn.onclick = () => openSlotDetail(hours, minutes, timeString);

            // Done Button
            const doneBtn = document.createElement('button'); doneBtn.className = 'done-click-btn';
            if(checkbox.checked) { doneBtn.innerHTML = 'âœ“'; doneBtn.classList.add('btn-checked'); }
            
            doneBtn.onclick = () => {
                const newState = !checkbox.checked;
                checkbox.checked = newState;
                localStorage.setItem(checkId, newState);
                input.classList.toggle('task-done', newState);
                doneBtn.classList.toggle('btn-checked', newState);
                doneBtn.innerHTML = newState ? 'âœ“' : '';
                calculateScore();
                if (newState) {
                    playDivineSound();
                    const rect = doneBtn.getBoundingClientRect();
                    explodeConfetti(rect.left + 15, rect.top + 15);
                    row.classList.add('victory-glow'); 
                    setTimeout(() => row.classList.remove('victory-glow'), 800);
                }
            };

            const calBtn = document.createElement('button'); calBtn.className = 'cal-btn'; calBtn.innerHTML = 'ğŸ“…';
            calBtn.onclick = () => addToGoogleCalendar(hours, minutes, input.value, select.value);

            actionGroup.append(detailBtn, calBtn, doneBtn);

            row.append(createEl('div','time-label',timeString), checkbox, select, input, actionGroup);
            container.appendChild(row);
        }
    }
    
    function createEl(tag, cls, txt) { const el = document.createElement(tag); if(cls) el.className = cls; if(txt) el.textContent = txt; return el; }

    // --- SLOT DETAIL LOGIC ---
    function openSlotDetail(h, m, timeStr) {
        const dateKey = formatDateKey(currentDate);
        const detailKey = `detail_${dateKey}_${h}-${m}`;
        const data = JSON.parse(localStorage.getItem(detailKey) || "{}");
        
        document.getElementById('slot-detail-time').innerText = `${timeStr} (${dateKey})`;
        document.getElementById('slot-detail-id').value = detailKey;
        
        document.getElementById('slot-jaap').value = data.jaap || '';
        document.getElementById('slot-focus').value = data.focus || 50;
        document.getElementById('focus-val').innerText = data.focus || 50;
        document.getElementById('slot-mood').value = data.mood || '';
        document.getElementById('slot-feeling').value = data.feeling || '';
        
        document.getElementById('slot-device').value = data.device || '';
        document.getElementById('slot-location').value = data.location || '';
        checkDeviceRule();

        document.getElementById('slot-detail-modal').style.display = 'block';
    }

    function checkDeviceRule() {
        const dev = document.getElementById('slot-device').value;
        const warning = document.getElementById('device-warning');
        if(dev === 'Mobile') warning.style.display = 'block';
        else warning.style.display = 'none';
    }

    function saveSlotDetail() {
        const key = document.getElementById('slot-detail-id').value;
        const device = document.getElementById('slot-device').value;
        const loc = document.getElementById('slot-location').value;
        
        // Critical Check: Office + Mobile
        if(loc === 'Office' && device === 'Mobile') {
            alert("âš ï¸ CRITICAL ALERT: You are trading on Mobile at Office. This is highly dangerous for your psychology.");
            if(confirm("Do you want to log this as a 'Discipline Error' automatically?")) {
                const mKey = getMistakeKey();
                let mistakes = JSON.parse(localStorage.getItem(mKey) || "[]");
                mistakes.push({ id: Date.now(), severity: 'critical', desc: 'Mobile Trading at Office', fix: 'Leave phone in drawer.' });
                localStorage.setItem(mKey, JSON.stringify(mistakes));
                renderMistakes();
                calculateScore();
            }
        }

        const data = {
            jaap: document.getElementById('slot-jaap').value,
            focus: document.getElementById('slot-focus').value,
            mood: document.getElementById('slot-mood').value,
            feeling: document.getElementById('slot-feeling').value,
            device: device,
            location: loc
        };
        
        if(data.jaap || data.mood || data.feeling || data.focus != 50 || data.device || data.location) {
            localStorage.setItem(key, JSON.stringify(data));
        } else {
            localStorage.removeItem(key);
        }
        closeSlotDetail();
        refreshView();
    }

    function closeSlotDetail() { document.getElementById('slot-detail-modal').style.display = 'none'; }

    // --- P&L LOGIC ---
    function savePnL() {
        const key = formatDateKey(currentDate);
        localStorage.setItem(`pnl_${key}`, document.getElementById('daily-pnl').value);
        localStorage.setItem(`mindset_${key}`, document.getElementById('daily-mindset').value);
        calculateScore();
    }
    function loadPnL() {
        const key = formatDateKey(currentDate);
        document.getElementById('daily-pnl').value = localStorage.getItem(`pnl_${key}`) || '';
        document.getElementById('daily-mindset').value = localStorage.getItem(`mindset_${key}`) || '';
    }

    // --- MISTAKE LOGIC ---
    function getMistakeKey() { return `mistakes_${formatDateKey(currentDate)}`; }
    
    function addMistake() {
        const severity = document.getElementById('mistake-severity').value;
        const desc = document.getElementById('mistake-desc').value.trim();
        const fix = document.getElementById('mistake-fix').value.trim();
        if(!desc) return alert("Please name the mistake.");
        
        const key = getMistakeKey();
        let mistakes = JSON.parse(localStorage.getItem(key) || "[]");
        mistakes.push({ id: Date.now(), severity, desc, fix });
        localStorage.setItem(key, JSON.stringify(mistakes));
        
        document.getElementById('mistake-desc').value = '';
        document.getElementById('mistake-fix').value = '';
        renderMistakes(); 
        calculateScore();
    }
    
    function renderMistakes() {
        const list = document.getElementById('mistake-list'); 
        list.innerHTML = '';
        const mistakes = JSON.parse(localStorage.getItem(getMistakeKey()) || "[]");
        mistakes.forEach(m => {
            const div = document.createElement('div'); 
            div.className = `mistake-item mistake-${m.severity}`;
            const fixText = m.fix ? `<span class="suggestion-text">Correction: ${m.fix}</span>` : '';
            div.innerHTML = `<div style="flex:1;"><div><span class="mistake-tag tag-${m.severity}">${m.severity}</span> <b>${m.desc}</b></div>${fixText}</div><button class="btn-delete" onclick="deleteMistake(${m.id})">Ã—</button>`;
            list.appendChild(div);
        });
    }
    
    function deleteMistake(id) {
        const key = getMistakeKey();
        let mistakes = JSON.parse(localStorage.getItem(key) || "[]").filter(m => m.id !== id);
        localStorage.setItem(key, JSON.stringify(mistakes));
        renderMistakes(); 
        calculateScore();
    }

    // --- SCORING & PASS/FAIL LOGIC ---
    function calculateScore() {
        const dateKey = formatDateKey(currentDate);
        let total = 0, completed = 0;
        const interval = 30;
        for (let time = 0; time < 24 * 60; time += interval) {
            let h = Math.floor(time / 60); let m = time % 60;
            let slotId = `task_${dateKey}_${h}-${m}`;
            if (localStorage.getItem(slotId)?.trim()) {
                total++;
                if (localStorage.getItem(`check_${dateKey}_${h}-${m}`) === 'true') completed++;
            }
        }
        let score = total === 0 ? 0 : Math.round((completed / total) * 100);
        
        const mistakes = JSON.parse(localStorage.getItem(getMistakeKey()) || "[]");
        const criticalErrors = mistakes.filter(m => m.severity === 'critical').length;
        const mindset = document.getElementById('daily-mindset').value;
        const badMindsets = ['fomo', 'greed', 'revenge'];

        document.getElementById('daily-score').textContent = score + "%";
        document.getElementById('task-count').textContent = `${completed}/${total}`;
        document.getElementById('dash-critical-count').textContent = mistakes.length;
        localStorage.setItem(`score_${dateKey}`, score);

        // --- PASS / FAIL LOGIC ---
        const badge = document.getElementById('day-result-badge');
        let isFail = false;
        
        // Condition 1: Any Critical Mistake = FAIL
        if (criticalErrors > 0) isFail = true;
        // Condition 2: Bad Mindset = FAIL
        if (badMindsets.includes(mindset)) isFail = true;
        // Condition 3: Score < 70% (if tasks exist) = FAIL
        if (total > 0 && score < 70) isFail = true;

        if (isFail) {
            badge.textContent = "FAIL";
            badge.className = "result-stamp stamp-fail";
        } else {
            // Only pass if there is some activity
            if(total > 0 || document.getElementById('daily-pnl').value !== "") {
                badge.textContent = "PASS";
                badge.className = "result-stamp stamp-pass";
            } else {
                badge.textContent = "N/A";
                badge.className = "result-stamp stamp-neutral";
            }
        }
    }

    // --- ANALYTICS (FIXED RENDER ORDER) ---
    function runDetailedAnalysis() {
        document.getElementById('analysis-modal').style.display = 'block';
        requestAnimationFrame(() => {
            try {
                const dateKey = formatDateKey(currentDate);
                const mistakes = JSON.parse(localStorage.getItem(getMistakeKey()) || "[]");
                
                // Stats
                document.getElementById('modal-daily-score').textContent = (localStorage.getItem(`score_${dateKey}`) || 0) + "%";
                document.getElementById('modal-critical-count').textContent = mistakes.length;

                let sumScore=0, count=0, netPnL=0;
                for(let i=0; i<7; i++) {
                    const d = new Date(); d.setDate(d.getDate()-i);
                    const k = formatDateKey(d);
                    const s = localStorage.getItem(`score_${k}`);
                    if(s) { sumScore += parseInt(s); count++; }
                    netPnL += parseFloat(localStorage.getItem(`pnl_${k}`)||0);
                }
                if(document.getElementById('modal-weekly-score')) document.getElementById('modal-weekly-score').textContent = (count?Math.round(sumScore/count):0)+"%";
                if(document.getElementById('modal-profit-sum')) document.getElementById('modal-profit-sum').textContent = netPnL.toFixed(2);
                
                // SCRAPE SLOT DETAILS
                let totalJaap = 0, totalFocus = 0, focusCount = 0;
                let moodCounts = { 'Calm':0, 'Focused':0, 'Aggressive':0, 'Distracted':0, 'Anxious':0, 'Happy':0 };
                let focusTrend = [];
                let labelsTrend = [];
                let laptopCount = 0, mobileCount = 0;

                for(let t=0; t<24*60; t+=30) {
                    let h=Math.floor(t/60), m=t%60;
                    const detailKey = `detail_${dateKey}_${h}-${m}`;
                    const rawDetail = localStorage.getItem(detailKey);
                    
                    if (rawDetail) {
                        const detail = JSON.parse(rawDetail);
                        if(detail.jaap) totalJaap += parseInt(detail.jaap);
                        if(detail.focus) {
                            let f = parseInt(detail.focus);
                            if (!isNaN(f)) {
                                totalFocus += f;
                                focusCount++;
                                focusTrend.push(f);
                                labelsTrend.push(`${h}:${m<10?'0'+m:m}`);
                            }
                        }
                        if(detail.mood && moodCounts[detail.mood] !== undefined) moodCounts[detail.mood]++;
                        if(detail.device === 'Laptop') laptopCount++;
                        if(detail.device === 'Mobile') mobileCount++;
                    }
                }
                
                if(document.getElementById('modal-jaap-count')) document.getElementById('modal-jaap-count').textContent = totalJaap;
                if(document.getElementById('modal-focus-avg')) document.getElementById('modal-focus-avg').textContent = focusCount > 0 ? Math.round(totalFocus/focusCount) + "%" : "0%";
                
                const totalDev = laptopCount + mobileCount;
                const devScore = totalDev === 0 ? 0 : Math.round((laptopCount / totalDev) * 100);
                if(document.getElementById('modal-device-score')) document.getElementById('modal-device-score').textContent = devScore + "%";

                // DAMAGE REPORT
                const report = document.getElementById('modal-damage-report');
                if(mistakes.length === 0) {
                    report.innerHTML = `<div style="text-align:center; color:var(--peacock-green); padding:20px;">ğŸ›¡ï¸ No Tactical Errors Recorded Today. Excellent Discipline!</div>`;
                } else {
                    let html = `<table class="damage-table"><tr><th>Mistake</th><th>Severity</th><th>Suggestion / Fix</th></tr>`;
                    mistakes.forEach(m => {
                        let suggestion = m.fix ? `<b>Plan:</b> ${m.fix}` : getSmartSuggestion(m.desc);
                        let rowColor = m.severity === 'critical' ? 'rgba(255, 77, 77, 0.1)' : 'transparent';
                        html += `<tr style="background:${rowColor}"><td>${m.desc}</td><td><span class="mistake-tag tag-${m.severity}">${m.severity}</span></td><td class="suggestion-cell">${suggestion}</td></tr>`;
                    });
                    html += `</table>`;
                    report.innerHTML = html;
                }

                renderHeatmap();
                setTimeout(() => { renderCharts(mistakes, moodCounts, focusTrend, labelsTrend); }, 100);

            } catch (e) {
                console.error(e);
                alert("Analytics Error: " + e.message);
            }
        });
    }

    function renderHeatmap() {
        const hm = document.getElementById('yearly-heatmap'); hm.innerHTML='';
        const today = new Date();
        for(let i=364; i>=0; i--) {
            const d = new Date(); d.setDate(today.getDate()-i);
            const k = formatDateKey(d);
            const sc = parseInt(localStorage.getItem(`score_${k}`)||0);
            const box = document.createElement('div'); box.className='heatmap-box';
            if(sc>0) box.classList.add('heat-1');
            if(sc>50) box.classList.add('heat-2');
            if(sc>80) box.classList.add('heat-3');
            if(sc===100) box.classList.add('heat-4');
            if(sc===0) box.classList.add('heat-0');
            box.title = `${k}: ${sc}%`;
            hm.appendChild(box);
        }
    }
    
    function renderChart(id, type, data, options) {
        const canvas = document.getElementById(id);
        if(!canvas) return;
        if (window.divineCharts[id]) { window.divineCharts[id].destroy(); }
        const ctx = canvas.getContext('2d');
        window.divineCharts[id] = new Chart(ctx, { type, data, options });
    }

    function renderCharts(mistakes, moodCounts, focusData, focusLabels) {
        // 1. Mood Chart
        let moodData = Object.values(moodCounts);
        let moodLabels = Object.keys(moodCounts);
        if (moodData.every(val => val === 0)) { moodData = [1]; moodLabels = ['No Data']; }

        renderChart('moodDoughnutChart', 'doughnut', {
            labels: moodLabels,
            datasets: [{ data: moodData, backgroundColor: ['#4bc0c0', '#36a2eb', '#ff6b6b', '#c9cbcf', '#9966ff', '#ffcd56'], borderWidth: 0 }]
        }, { plugins: { legend: { position: 'right', labels: { color: 'white' } } } });

        // 2. Focus Chart
        renderChart('intradayFocusChart', 'line', {
            labels: focusLabels.length ? focusLabels : ['Start'],
            datasets: [{ label: 'Focus %', data: focusData.length ? focusData : [0], borderColor: '#ffd700', tension: 0.3, fill: true, backgroundColor: 'rgba(255, 215, 0, 0.1)' }]
        }, {
            scales: { y: { beginAtZero: true, max: 100, grid:{color:'#333'} }, x:{grid:{color:'#333'}} },
            plugins: { legend: { display: false } }
        });

        // 3. Screen Time Trend
        const historyLabels = [];
        const historyScreen = [];
        for(let i=6; i>=0; i--) {
            const d = new Date(); d.setDate(d.getDate()-i);
            historyLabels.push(d.toLocaleDateString('en-US',{weekday:'short'}));
            historyScreen.push(parseInt(localStorage.getItem(`screen_time_${formatDateKey(d)}`) || 0) / 60);
        }
        renderChart('screenTimeChart', 'bar', {
            labels: historyLabels,
            datasets: [{ label: 'Screen Time (Hrs)', data: historyScreen, backgroundColor: '#36a2eb' }]
        }, {
            scales: { y: { beginAtZero: true, grid:{color:'#333'} }, x:{grid:{color:'#333'}} },
            plugins: { legend: { display: false } }
        });

        // 4. Mistake Chart
        const crit = mistakes.filter(m => m.severity === 'critical').length;
        const med = mistakes.filter(m => m.severity === 'medium').length;
        const minor = mistakes.filter(m => m.severity === 'minor').length;
        let mistData = [crit, med, minor];
        let mistColors = ['#ff4d4d', '#ff9f43', '#feca57'];
        if(crit+med+minor === 0) { mistData = [1]; mistColors = ['#333']; }

        renderChart('mistakePieChart', 'pie', {
            labels: ['Critical', 'Medium', 'Minor'],
            datasets: [{ data: mistData, backgroundColor: mistColors, borderWidth: 0 }]
        }, { plugins: { legend: { labels: { color: 'white' } } } });

        // 5. Trend Chart
        const historyData = [];
        for(let i=6; i>=0; i--) {
            const d = new Date(); d.setDate(d.getDate()-i);
            historyData.push(localStorage.getItem(`score_${formatDateKey(d)}`)||0);
        }
        renderChart('disciplineChart', 'line', {
            labels: historyLabels,
            datasets: [{ label: 'Karma Score', data: historyData, borderColor: '#00ffcc', tension: 0.3, fill: true, backgroundColor: 'rgba(0, 255, 204, 0.1)' }]
        }, {
            scales: { y: { beginAtZero: true, max: 100, grid: { color: '#333'} }, x: { grid: { color: '#333'} } },
            plugins: { legend: { display: false } }
        });
    }

    // --- UTILS ---
    function addToGoogleCalendar(h, m, task, catKey) {
        if (!task) return alert("No task!");
        const title = `${categories[catKey]?.emoji || 'ğŸ”¹'} ${task}`;
        const d = new Date(currentDate); d.setHours(h, m, 0);
        const iso = d.toISOString().replace(/-|:|\.\d\d\d/g, "").substring(0,15) + 'Z';
        window.open(`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${iso}/${iso}`);
    }

    function saveReflection(type) { localStorage.setItem(`reflection_${formatDateKey(currentDate)}_${type}`, document.getElementById(type).value); }
    function loadReflections() { 
        ['good-things', 'learning'].forEach(t => document.getElementById(t).value = localStorage.getItem(`reflection_${formatDateKey(currentDate)}_${t}`) || ''); 
    }
    
    function toggleModal(id) { 
        const m = document.getElementById(id); 
        if (id !== 'analysis-modal') { 
            if(id === 'category-modal') renderCategoryManager();
            m.style.display = (m.style.display === "block") ? "none" : "block"; 
        } else { 
            m.style.display = "block";
        }
    }
    
    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            event.target.style.display = "none";
        }
    }

    function renderCategoryManager() {
        const c = document.getElementById('cat-list-container'); c.innerHTML = '';
        for (const [k, v] of Object.entries(categories)) {
            const div = document.createElement('div'); div.className = 'cat-row'; div.style.display='flex'; div.style.gap='10px'; div.style.marginBottom='10px';
            div.innerHTML = `<input class="cat-input" style="width:40px" value="${v.emoji}" onchange="categories['${k}'].emoji=this.value;saveCategories()"> 
                             <input class="cat-input" style="flex:1" value="${v.label}" onchange="categories['${k}'].label=this.value;saveCategories()">
                             <button class="btn-delete" onclick="delete categories['${k}'];saveCategories();renderCategoryManager()">ğŸ—‘ï¸</button>`;
            c.appendChild(div);
        }
    }
    function addNewCategory() { categories['cat_'+Date.now()] = {label:'New', emoji:'ğŸ”¹', color:'#fff'}; saveCategories(); renderCategoryManager(); }

    function playDivineSound() {
        const ctx = new (window.AudioContext||window.webkitAudioContext)();
        const o = ctx.createOscillator(); const g = ctx.createGain();
        o.connect(g); g.connect(ctx.destination);
        o.frequency.setValueAtTime(880, ctx.currentTime); o.frequency.exponentialRampToValueAtTime(110, ctx.currentTime + 1.5);
        g.gain.setValueAtTime(0.1, ctx.currentTime); g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 1.5);
        o.start(); o.stop(ctx.currentTime + 1.5);
    }
    function explodeConfetti(x, y) {
        for(let i=0; i<20; i++) {
            const p = document.createElement('div'); p.className = 'confetti';
            p.style.left = x+'px'; p.style.top = y+'px'; p.style.backgroundColor = '#ffd700';
            document.body.appendChild(p);
            const angle = Math.random()*Math.PI*2, vel = 2+Math.random()*3;
            p.animate([{transform:'translate(0,0)', opacity:1}, {transform:`translate(${Math.cos(angle)*60*vel}px, ${Math.sin(angle)*60*vel}px)`, opacity:0}], {duration:600}).onfinish=()=>p.remove();
        }
    }

    // --- LOGIN SYSTEM ---
    const CORRECT_PASSWORDS = ["108", "trader", "admin", "krishna"]; // Add your passwords here

    function attemptLogin() {
        const input = document.getElementById('login-pass');
        const val = (input && input.value || '').trim().toLowerCase();
        const msg = document.getElementById('login-msg');
        const overlay = document.getElementById('login-overlay');
        const box = document.querySelector('.login-box');

        if (CORRECT_PASSWORDS.includes(val)) {
            // SUCCESS
            if(msg) { msg.style.color = "var(--profit-green)"; msg.innerText = "ACCESS GRANTED"; }
            
            // Play Sound
            try { playDivineSound(); } catch(e){}
            
            // UI Animation
            if(input) input.blur();
            if(box) { box.style.borderColor = "var(--profit-green)"; box.style.boxShadow = "0 0 50px var(--profit-green)"; }
            
            setTimeout(() => {
                if(overlay) overlay.classList.add('unlock-success'); // Slide up
            }, 800);
            
            // Allow scrolling again
            document.body.style.overflow = "auto";
            
        } else {
            // FAIL
            if(msg) { msg.style.color = "var(--mistake-red)"; msg.innerText = "ACCESS DENIED"; }
            
            // Shake Animation
            if(box) {
                box.classList.remove('shake');
                void box.offsetWidth; // trigger reflow
                box.classList.add('shake');
            }
            
            // Clear input
            if(input) { input.value = ''; input.focus(); }
        }
    }

    function handleEnter(e) {
        if(e.key === 'Enter') attemptLogin();
    }

    // Lock Scroll on Load
    document.body.style.overflow = "hidden";

    init();
</script>


</body></html>